{"version":3,"file":"DefaultUserAgentParser.js","sourceRoot":"","sources":["../../src/useragentparser/DefaultUserAgentParser.ts"],"names":[],"mappings":";AAAA,qEAAqE;AACrE,sCAAsC;;;;;AAEtC,6EAA6E;AAC7E,+CAAwC;AAGxC,0EAAkD;AAGlD;;;GAGG;AACH,MAAqB,sBAAsB;IAQzC,YAAY,MAAc;;QACxB,IAAI;YACF,IAAI,CAAC,YAAY;gBACf,SAAS,IAAI,SAAS,CAAC,SAAS;oBAC9B,CAAC,CAAC,IAAI,uBAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,SAAS,EAAE;oBAC/C,CAAC,CAAC,SAAS,CAAC;SACjB;QAAC,OAAO,KAAK,EAAE;YACd,0BAA0B;YAC1B,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SAC7B;QAED,IAAI,CAAC,mBAAmB;YACtB,CAAA,MAAA,MAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,OAAO,0CAAE,OAAO,0CAAE,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,KAAI,sBAAsB,CAAC,WAAW,CAAC;QAC3F,IAAI,CAAC,WAAW,GAAG,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,OAAO,CAAC,IAAI,KAAI,sBAAsB,CAAC,WAAW,CAAC;QACzF,IAAI,CAAC,cAAc,GAAG,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,OAAO,CAAC,OAAO,KAAI,sBAAsB,CAAC,WAAW,CAAC;QAC/F,IAAI,CAAC,UAAU;YACb,CAAC,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,MAAM,CAAC,MAAM,KAAI,EAAE,EAAE,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,MAAM,CAAC,KAAK,KAAI,EAAE,CAAC;iBAC5E,IAAI,CAAC,GAAG,CAAC;iBACT,IAAI,EAAE,IAAI,sBAAsB,CAAC,WAAW,CAAC;IACpD,CAAC;IAED,eAAe;;QACb,OAAO;YACL,mBAAmB,EAAE,IAAI,CAAC,mBAAmB;YAC7C,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,cAAc,EAAE,IAAI,CAAC,cAAc;YACnC,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,MAAM,EAAE,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,EAAE,CAAC,IAAI,KAAI,sBAAsB,CAAC,WAAW;YACxE,SAAS,EAAE,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,EAAE,CAAC,OAAO,KAAI,sBAAsB,CAAC,WAAW;YAC9E,UAAU,EAAE,oBAAU,CAAC,UAAU;YACjC,OAAO,EAAE,oBAAU,CAAC,OAAO;SAC5B,CAAC;IACJ,CAAC;;AAxCH,yCAyCC;AAxCyB,kCAAW,GAAG,aAAa,CAAC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\n// Use \"ua-parser-js\" over \"detect-browser\" to get more detailed information.\nimport { UAParser } from 'ua-parser-js';\n\nimport Logger from '../logger/Logger';\nimport Versioning from '../versioning/Versioning';\nimport UserAgentParser from './UserAgentParser';\n\n/**\n * [[DefaultUserAgentParser]] uses UAParser to parse the browser's user agent.\n * It is responsible to hold and provide browser, OS and device specific information.\n */\nexport default class DefaultUserAgentParser implements UserAgentParser {\n  private static readonly UNAVAILABLE = 'Unavailable';\n  private parserResult: UAParser.IResult;\n  private browserName: string;\n  private browserVersion: string;\n  private deviceName: string;\n  private browserMajorVersion: string;\n\n  constructor(logger: Logger) {\n    try {\n      this.parserResult =\n        navigator && navigator.userAgent\n          ? new UAParser(navigator.userAgent).getResult()\n          : undefined;\n    } catch (error) {\n      /* istanbul ignore next */\n      logger.error(error.message);\n    }\n\n    this.browserMajorVersion =\n      this.parserResult?.browser?.version?.split('.')[0] || DefaultUserAgentParser.UNAVAILABLE;\n    this.browserName = this.parserResult?.browser.name || DefaultUserAgentParser.UNAVAILABLE;\n    this.browserVersion = this.parserResult?.browser.version || DefaultUserAgentParser.UNAVAILABLE;\n    this.deviceName =\n      [this.parserResult?.device.vendor || '', this.parserResult?.device.model || '']\n        .join(' ')\n        .trim() || DefaultUserAgentParser.UNAVAILABLE;\n  }\n\n  getParserResult(): { [key: string]: string } {\n    return {\n      browserMajorVersion: this.browserMajorVersion,\n      browserName: this.browserName,\n      browserVersion: this.browserVersion,\n      deviceName: this.deviceName,\n      osName: this.parserResult?.os.name || DefaultUserAgentParser.UNAVAILABLE,\n      osVersion: this.parserResult?.os.version || DefaultUserAgentParser.UNAVAILABLE,\n      sdkVersion: Versioning.sdkVersion,\n      sdkName: Versioning.sdkName,\n    };\n  }\n}\n"]}