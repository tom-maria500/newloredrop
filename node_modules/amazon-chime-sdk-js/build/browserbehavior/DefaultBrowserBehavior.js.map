{"version":3,"file":"DefaultBrowserBehavior.js","sourceRoot":"","sources":["../../src/browserbehavior/DefaultBrowserBehavior.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { detect } from 'detect-browser';\nimport { UAParser } from 'ua-parser-js';\n\nimport BrowserBehavior from './BrowserBehavior';\nimport ExtendedBrowserBehavior from './ExtendedBrowserBehavior';\n\nexport default class DefaultBrowserBehavior implements BrowserBehavior, ExtendedBrowserBehavior {\n  private readonly FALLBACK_BROWSER = {\n    type: 'browser',\n    name: 'unknown',\n    version: 'unknown',\n    os: 'unknown',\n  };\n  private readonly browser = detect() || this.FALLBACK_BROWSER;\n  private readonly uaParserResult =\n    navigator && navigator.userAgent ? new UAParser(navigator.userAgent).getResult() : null;\n\n  private browserSupport: { [id: string]: number } = {\n    chrome: 78,\n    'edge-chromium': 79,\n    electron: 7,\n    firefox: 75,\n    ios: 13,\n    safari: 13,\n    opera: 66,\n    samsung: 12,\n    crios: 86,\n    fxios: 23,\n    'ios-webview': 605,\n    'chromium-webview': 92,\n  };\n\n  private browserName: { [id: string]: string } = {\n    chrome: 'Google Chrome',\n    'edge-chromium': 'Microsoft Edge',\n    electron: 'Electron',\n    firefox: 'Mozilla Firefox',\n    ios: 'Safari iOS',\n    safari: 'Safari',\n    opera: 'Opera',\n    samsung: 'Samsung Internet',\n    crios: 'Chrome iOS',\n    fxios: 'Firefox iOS',\n    'ios-webview': 'WKWebView iOS',\n    'chromium-webview': 'Chrome WebView',\n  };\n\n  private chromeLike: string[] = [\n    'chrome',\n    'edge-chromium',\n    'chromium-webview',\n    'opera',\n    'samsung',\n  ];\n\n  private webkitBrowsers: string[] = ['crios', 'fxios', 'safari', 'ios', 'ios-webview', 'edge-ios'];\n  private static MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK = 16;\n  private static MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK = 106;\n\n  version(): string {\n    return this.browser.version;\n  }\n\n  majorVersion(): number {\n    return this.version() !== null ? parseInt(this.version().split('.')[0]) : -1;\n  }\n\n  osMajorVersion(): number {\n    return parseInt(this.uaParserResult.os.version.split('.')[0]);\n  }\n\n  private engine(): string {\n    return this.uaParserResult.engine.name;\n  }\n\n  private engineMajorVersion(): number {\n    return parseInt(this.uaParserResult.engine.version.split('.')[0]);\n  }\n\n  name(): string {\n    return this.browser.name;\n  }\n\n  hasChromiumWebRTC(): boolean {\n    for (const browser of this.chromeLike) {\n      if (browser === this.browser.name) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  hasWebKitWebRTC(): boolean {\n    for (const browser of this.webkitBrowsers) {\n      if (browser === this.browser.name) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  hasFirefoxWebRTC(): boolean {\n    return this.isFirefox();\n  }\n\n  requiresPlaybackLatencyHintForAudioContext(): boolean {\n    return navigator.userAgent.indexOf('Windows') !== -1;\n  }\n\n  supportsCanvasCapturedStreamPlayback(): boolean {\n    return (\n      // Desktop browser\n      (!this.isIOSSafari() && !this.isIOSChrome() && !this.isIOSFirefox() && !this.isIOSEdge()) ||\n      // iOS Safari (Firefox on iOS with desktop view will be identified as iOS Safari\n      (this.isIOSSafari() &&\n        this.majorVersion() >= DefaultBrowserBehavior.MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK) ||\n      // Chrome, Edge, or Firefox (mobile view) on iOS\n      this.majorVersion() >=\n        DefaultBrowserBehavior.MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK\n    );\n  }\n\n  supportsBackgroundFilter(): boolean {\n    // disable Safari 15\n    // see: https://github.com/aws/amazon-chime-sdk-js/issues/1059\n    if (this.name() === 'safari' && this.majorVersion() === 15) {\n      return false;\n    }\n\n    if (!this.supportsCanvasCapturedStreamPlayback()) {\n      return false;\n    }\n\n    return true;\n  }\n\n  supportsVideoLayersAllocationRtpHeaderExtension(): boolean {\n    return this.hasChromiumWebRTC();\n  }\n\n  supportsDependencyDescriptorRtpHeaderExtension(): boolean {\n    return this.hasChromiumWebRTC();\n  }\n\n  supportsScalableVideoCoding(): boolean {\n    return (\n      // Currently `this.hasChromiumWebRTC() && this.engine() === 'Blink'` completely\n      // overlaps but we keep both just in case that changes in the future.\n      this.hasChromiumWebRTC() && this.engine() === 'Blink' && this.engineMajorVersion() >= 111\n    );\n  }\n\n  supportsAudioRedundancy(): boolean {\n    if (this.hasChromiumWebRTC()) {\n      // Audio redundancy may cause video decoding failure for Chromium version 106 and\n      // earlier. Marking such Chromium versions as not supporting audio redundancy.\n      return this.engineMajorVersion() >= 107;\n    }\n    return !this.hasFirefoxWebRTC();\n  }\n\n  requiresResolutionAlignment(width: number, height: number): [number, number] {\n    if (this.isAndroid() && this.isPixel3()) {\n      return [Math.ceil(width / 64) * 64, Math.ceil(height / 64) * 64];\n    }\n    return [width, height];\n  }\n\n  requiresCheckForSdpConnectionAttributes(): boolean {\n    return !this.isIOSSafari() && !this.isIOSChrome() && !this.isIOSFirefox();\n  }\n\n  requiresIceCandidateGatheringTimeoutWorkaround(): boolean {\n    return this.hasChromiumWebRTC();\n  }\n\n  requiresBundlePolicy(): RTCBundlePolicy {\n    return 'max-bundle';\n  }\n\n  requiresNoExactMediaStreamConstraints(): boolean {\n    return this.isSamsungInternet();\n  }\n\n  requiresGroupIdMediaStreamConstraints(): boolean {\n    return this.isSamsungInternet();\n  }\n\n  getDisplayMediaAudioCaptureSupport(): boolean {\n    return this.isChrome() || this.isEdge();\n  }\n\n  // There's a issue in Chormium WebView that causes enumerate devices to return empty labels, this is a check for this issue.\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=669492\n  doesNotSupportMediaDeviceLabels(): boolean {\n    return this.browser.name === 'chromium-webview';\n  }\n\n  isSupported(): boolean {\n    if (\n      !this.browserSupport[this.browser.name] ||\n      this.majorVersion() < this.browserSupport[this.browser.name]\n    ) {\n      return false;\n    }\n    if (this.browser.name === 'firefox' && this.isAndroid()) {\n      return false;\n    }\n    return true;\n  }\n\n  isSimulcastSupported(): boolean {\n    return this.hasChromiumWebRTC();\n  }\n\n  supportDownlinkBandwidthEstimation(): boolean {\n    return !this.isFirefox();\n  }\n\n  supportString(): string {\n    if (this.isAndroid()) {\n      return `${this.browserName['chrome']} ${this.browserSupport['chrome']}+, ${this.browserName['samsung']} ${this.browserSupport['samsung']}+`;\n    }\n    const s: string[] = [];\n    for (const k in this.browserSupport) {\n      s.push(`${this.browserName[k]} ${this.browserSupport[k]}+`);\n    }\n    return s.join(', ');\n  }\n\n  async supportedVideoCodecs(): Promise<string[]> {\n    const pc = new RTCPeerConnection();\n    pc.addTransceiver('video', { direction: 'inactive', streams: [] });\n    return (await pc.createOffer({ offerToReceiveVideo: true })).sdp\n      .split('\\r\\n')\n      .filter(x => {\n        return x.includes('a=rtpmap:');\n      })\n      .map(x => {\n        return x.replace(/.* /, '').replace(/\\/.*/, '');\n      })\n      .filter((v, i, a) => {\n        return a.indexOf(v) === i;\n      })\n      .filter(x => {\n        return x !== 'rtx' && x !== 'red' && x !== 'ulpfec';\n      });\n  }\n\n  supportsSetSinkId(): boolean {\n    return 'setSinkId' in HTMLAudioElement.prototype;\n  }\n\n  disableResolutionScaleDown(): boolean {\n    return this.isAndroid();\n  }\n\n  disable480pResolutionScaleDown(): boolean {\n    return /( Chrome\\/98\\.)/i.test(navigator.userAgent) && this.browser.os.startsWith('Windows');\n  }\n\n  requiresDisablingH264Encoding(): boolean {\n    return this.isIOS() && (this.version() === '15.1.0' || /( OS 15_1)/i.test(navigator.userAgent));\n  }\n\n  // In Safari, a hidden video element can show a black screen.\n  // See https://bugs.webkit.org/show_bug.cgi?id=241152 for more information.\n  requiresVideoPlayWorkaround(): boolean {\n    return this.isSafari();\n  }\n\n  requiresAudioContextResetOnDeviceFailureForWebAudio(): boolean {\n    // In iOS Safari, when an audio media stream fails (i.e. in the case of being\n    // unplugged), the audio context becomes broken, and e.g. stops transmitting\n    // audio. This can be mitigated by suspending and resuming the context.\n    //\n    // The WebKit bug is https://bugs.webkit.org/show_bug.cgi?id=232640\n    return this.isIOS();\n  }\n\n  /**\n   * Check if the current browser supports the [[VideoFxProcessor]].\n   * @returns boolean representing if browser supports [[VideoFxProcessor]].\n   */\n  isVideoFxSupportedBrowser(): boolean {\n    // Not supported on safari 15 and on environments without canvas capture playback\n    return this.supportsBackgroundFilter();\n  }\n\n  // These helpers should be kept private to encourage\n  // feature detection instead of browser detection.\n  private isIOSSafari(): boolean {\n    return (\n      this.browser.name === 'ios' ||\n      this.browser.name === 'ios-webview' ||\n      (this.browser.name === 'safari' &&\n        /( Mac )/i.test(navigator.userAgent) &&\n        navigator.maxTouchPoints > 1) //Ipad\n    );\n  }\n\n  private isSafari(): boolean {\n    return this.browser.name === 'safari' || this.isIOSSafari();\n  }\n\n  private isFirefox(): boolean {\n    return this.browser.name === 'firefox';\n  }\n\n  private isIOSFirefox(): boolean {\n    return this.browser.name === 'fxios';\n  }\n\n  private isIOSChrome(): boolean {\n    return this.browser.name === 'crios';\n  }\n\n  private isChrome(): boolean {\n    return this.browser.name === 'chrome';\n  }\n\n  private isEdge(): boolean {\n    return this.browser.name === 'edge-chromium';\n  }\n\n  private isIOSEdge(): boolean {\n    return this.browser.name === 'edge-ios';\n  }\n\n  private isSamsungInternet(): boolean {\n    return this.browser.name === 'samsung';\n  }\n\n  private isAndroid(): boolean {\n    return /(android)/i.test(navigator.userAgent);\n  }\n\n  private isPixel3(): boolean {\n    return /( pixel 3)/i.test(navigator.userAgent);\n  }\n\n  private isIOS(): boolean {\n    // Is one of the supported iOS browsers\n    return this.isIOSSafari() || this.isIOSChrome() || this.isIOSFirefox();\n  }\n}\n"]}